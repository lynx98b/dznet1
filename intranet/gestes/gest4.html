<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Salima Traffic Lights Adventure</title>
<link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* __version__ = "v1.002" - Complet FR/EN/AR + animations */
  
  :root {
    --primary-orange: #ff8c00;
    --primary-pink: #ff80ab;
    --primary-blue: #4fc3f7;
    --primary-green: #2ea44f;
    --bg-sky: linear-gradient(to bottom, #87ceeb 0%, #e0f6ff 100%);
    --bg-ground: #36b37e;
    --shadow-soft: 0 8px 20px rgba(0,0,0,0.12);
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  body {
    font-family: 'Comic Neue', cursive;
    overflow-x: hidden;
    position: relative;
    background: var(--bg-sky);
    min-height: 100vh;
    transition: var(--transition-smooth);
  }

  body.rtl {
    direction: rtl;
    font-family: 'Noto Sans Arabic', 'Comic Neue', sans-serif;
  }

  .lang-switcher {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    display: flex;
    gap: 8px;
    background: rgba(255,255,255,0.95);
    padding: 8px;
    border-radius: 20px;
    box-shadow: var(--shadow-soft);
    backdrop-filter: blur(10px);
  }

  .lang-btn {
    padding: 8px 16px;
    border: 2px solid transparent;
    border-radius: 12px;
    background: #f0f0f0;
    cursor: pointer;
    font-weight: 700;
    font-size: 0.9rem;
    transition: var(--transition-smooth);
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .lang-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }

  .lang-btn.active {
    background: linear-gradient(135deg, var(--primary-orange), #ffa500);
    color: white;
    border-color: var(--primary-orange);
  }

  .ground {
    position: fixed;
    bottom: 0;
    width: 100%;
    height: 150px;
    background: var(--bg-ground);
    z-index: 0;
    overflow: hidden;
  }

  .ground::before {
    content: 'üå±üåøüå±üåæüå±üåøüå±üåæüå±üåøüå±üåæ';
    position: absolute;
    font-size: 1.5rem;
    animation: grassWave 3s ease-in-out infinite;
    white-space: nowrap;
  }

  @keyframes grassWave {
    0%, 100% { transform: translateX(0) rotate(0deg); }
    50% { transform: translateX(10px) rotate(2deg); }
  }

  .floating {
    position: fixed;
    pointer-events: none;
    animation: floatSmooth 8s ease-in-out infinite;
    filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
  }

  .cloud { font-size: 70px; }
  .sun { 
    font-size: 90px; 
    animation: sunRotate 20s linear infinite, floatSmooth 8s ease-in-out infinite;
  }

  @keyframes floatSmooth {
    0%, 100% { transform: translateY(0) translateX(0); }
    50% { transform: translateY(-25px) translateX(15px); }
  }

  @keyframes sunRotate {
    from { filter: hue-rotate(0deg) drop-shadow(2px 2px 8px rgba(255,200,0,0.4)); }
    to { filter: hue-rotate(360deg) drop-shadow(2px 2px 8px rgba(255,200,0,0.4)); }
  }

  .title {
    text-align: center;
    font-size: clamp(1.5rem, 5vw, 2.5rem);
    font-weight: 700;
    padding: 40px 20px 20px;
    margin-top: 60px;
    z-index: 2;
    position: relative;
    background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff6b6b);
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: rainbowTitle 4s linear infinite;
    filter: drop-shadow(2px 2px 4px rgba(255,255,255,0.8));
  }

  @keyframes rainbowTitle {
    to { background-position: 200% center; }
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    padding-bottom: 180px;
    position: relative;
    z-index: 1;
  }

  .dialogue-space {
    background: rgba(255,255,255,0.95);
    border-radius: 25px;
    padding: 30px;
    margin: 30px 0;
    box-shadow: var(--shadow-soft);
    backdrop-filter: blur(10px);
    border: 3px solid var(--primary-pink);
    animation: slideInDown 0.6s ease-out;
  }

  @keyframes slideInDown {
    from { opacity: 0; transform: translateY(-30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .chat {
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .bubble {
    max-width: 75%;
    padding: 15px 20px;
    border-radius: 20px;
    line-height: 1.5;
    font-size: clamp(0.95rem, 2.5vw, 1.1rem);
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    animation: bubblePop 0.4s ease-out;
    position: relative;
  }

  @keyframes bubblePop {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
  }

  .bubble.salima {
    background: linear-gradient(135deg, #ffd6ff, #ffe6ff);
    align-self: flex-start;
    border: 3px solid var(--primary-pink);
    border-bottom-left-radius: 5px;
  }

  .bubble.father {
    background: linear-gradient(135deg, #b3e5fc, #e1f5fe);
    align-self: flex-end;
    border: 3px solid var(--primary-blue);
    border-bottom-right-radius: 5px;
  }

  body.rtl .bubble.salima {
    align-self: flex-end;
    border-bottom-left-radius: 20px;
    border-bottom-right-radius: 5px;
  }

  body.rtl .bubble.father {
    align-self: flex-start;
    border-bottom-right-radius: 20px;
    border-bottom-left-radius: 5px;
  }

  .bubble .name {
    font-weight: 700;
    font-size: 0.95rem;
    margin-bottom: 6px;
    display: block;
  }

  .rules {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
    margin: 30px 0;
  }

  .rule {
    background: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: var(--shadow-soft);
    transition: var(--transition-smooth);
    border: 3px solid transparent;
    animation: fadeInUp 0.6s ease-out;
    animation-fill-mode: both;
  }

  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .rule:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 12px 30px rgba(0,0,0,0.15);
  }

  .rule:nth-child(1) { background: linear-gradient(135deg, #ffd6d6, #ffe6e6); border-color: #ff6b6b; animation-delay: 0.1s; }
  .rule:nth-child(2) { background: linear-gradient(135deg, #fff0b3, #fffbe6); border-color: #feca57; animation-delay: 0.2s; }
  .rule:nth-child(3) { background: linear-gradient(135deg, #d6ffd6, #e6ffe6); border-color: #2ea44f; animation-delay: 0.3s; }
  .rule:nth-child(4) { background: linear-gradient(135deg, #cce0ff, #e6f0ff); border-color: #4fc3f7; animation-delay: 0.4s; }
  .rule:nth-child(5) { background: linear-gradient(135deg, #e6ccff, #f0e6ff); border-color: #9b59b6; animation-delay: 0.5s; }
  .rule:nth-child(6) { background: linear-gradient(135deg, #ffe6cc, #fff5e6); border-color: #f39c12; animation-delay: 0.6s; }
  .rule:nth-child(7) { background: linear-gradient(135deg, #b3fff0, #d6fff7); border-color: #1abc9c; animation-delay: 0.7s; }
  .rule:nth-child(8) { background: linear-gradient(135deg, #ffccf2, #ffe6f7); border-color: #e91e63; animation-delay: 0.8s; }
  .rule:nth-child(9) { background: linear-gradient(135deg, #fff5b3, #fffbe6); border-color: #f1c40f; animation-delay: 0.9s; }
  .rule:nth-child(10){ background: linear-gradient(135deg, #d9ffb3, #eaffe6); border-color: #8bc34a; animation-delay: 1s; }

  .rule h4 {
    font-size: 1.3rem;
    margin-bottom: 12px;
    color: #333;
  }

  .rule p {
    margin: 8px 0;
    color: #555;
    line-height: 1.6;
  }

  .rule em {
    color: #666;
    font-size: 0.95rem;
  }

  .placeholder {
    width: 100%;
    height: 160px;
    background: #f8f9fa;
    border: 3px dashed #ccc;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    font-size: 3rem;
    color: #999;
    transition: var(--transition-smooth);
  }

  .placeholder:hover {
    border-color: var(--primary-orange);
    background: #fff;
    transform: scale(1.05);
  }

  .quiz-container {
    display: flex;
    flex-direction: column;
    gap: 25px;
    margin: 30px 0;
  }

  .quizbox {
    background: linear-gradient(135deg, #fff7e6, #fffbf0);
    padding: 25px;
    border-radius: 20px;
    box-shadow: var(--shadow-soft);
    border: 3px solid #ffd700;
    animation: fadeInUp 0.6s ease-out;
  }

  .quiz {
    font-weight: 700;
    font-size: 1.15rem;
    margin-bottom: 15px;
    color: #333;
  }

  .opts {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
  }

  .opts button {
    padding: 12px 20px;
    border-radius: 15px;
    border: 3px solid transparent;
    cursor: pointer;
    font-weight: 700;
    font-size: 1rem;
    background: white;
    transition: var(--transition-smooth);
    font-family: inherit;
  }

  .opts button:hover:not(:disabled) {
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.15);
    border-color: var(--primary-orange);
  }

  .opts button.correct {
    background: linear-gradient(135deg, #b3ffcc, #d4ffe6);
    border-color: var(--primary-green);
    animation: correctPulse 0.6s ease-out;
  }

  .opts button.wrong {
    background: linear-gradient(135deg, #ffb3b3, #ffe6e6);
    border-color: #d73a49;
    animation: wrongShake 0.5s ease-out;
  }

  @keyframes correctPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }

  @keyframes wrongShake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
  }

  .feedback {
    margin-top: 12px;
    font-weight: 700;
    font-size: 1.1rem;
  }

  .salima-char {
    position: fixed;
    bottom: 20px;
    left: 30px;
    width: 100px;
    filter: drop-shadow(4px 4px 8px rgba(0,0,0,0.2));
    transition: left 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    z-index: 10;
    animation: salimaWave 2s ease-in-out infinite;
  }

  @keyframes salimaWave {
    0%, 100% { transform: rotate(-5deg); }
    50% { transform: rotate(5deg); }
  }

  @media (max-width: 768px) {
    .lang-switcher {
      top: 10px;
      right: 10px;
      gap: 4px;
      padding: 6px;
    }

    .lang-btn {
      padding: 6px 10px;
      font-size: 0.8rem;
    }

    .title {
      margin-top: 80px;
      padding: 20px 15px 15px;
    }

    .container {
      padding: 15px;
      padding-bottom: 160px;
    }

    .rules {
      grid-template-columns: 1fr;
      gap: 20px;
    }

    .bubble {
      max-width: 85%;
    }

    .salima-char {
      width: 70px;
      left: 15px;
      bottom: 15px;
    }
  }

  @media (max-width: 480px) {
    .lang-btn {
      padding: 5px 8px;
      font-size: 0.75rem;
    }
    
    .opts button {
      font-size: 0.9rem;
      padding: 10px 15px;
    }
  }
</style>
</head>
<body>

  <div class="lang-switcher">
    <button class="lang-btn active" data-lang="fr" onclick="changeLang('fr')">
      <span>üá´üá∑</span> FR
    </button>
    <button class="lang-btn" data-lang="en" onclick="changeLang('en')">
      <span>üá¨üáß</span> EN
    </button>
    <button class="lang-btn" data-lang="ar" onclick="changeLang('ar')">
      <span>üá∏üá¶</span> AR
    </button>
  </div>

  <div class="ground"></div>

  <div class="floating cloud" style="top:8%; left:5%;">‚òÅÔ∏è</div>
  <div class="floating cloud" style="top:15%; left:80%;">‚òÅÔ∏è</div>
  <div class="floating cloud" style="top:25%; left:40%;">‚òÅÔ∏è</div>
  <div class="floating sun" style="top:5%; left:88%;">üåû</div>

  <div class="container">
    <div class="title" id="pageTitle">üåü L'Aventure de Salima aux Feux de Circulation üåü</div>

    <div class="dialogue-space">
      <div class="chat" id="chat"></div>
    </div>

    <div class="rules" id="rules"></div>

    <div class="quiz-container" id="quizzes"></div>
  </div>

  <div class="salima-char" id="salimaChar">üëß</div>

<script>
// __version__ = "v1.002"
let currentLang = 'fr';

const translations = {
  fr: {
    title: "üåü L'Aventure de Salima aux Feux de Circulation üåü",
    salimaName: "Salima üëß",
    fatherName: "Papa üë®‚Äçü¶±",
    dialogue: [
      {who:'salima', text:"Papa, pourquoi y a-t-il autant de feux et de panneaux ?"},
      {who:'father', text:"Ils aident tout le monde √† rester en s√©curit√©. Les feux indiquent aux conducteurs et pi√©tons ce qu'ils doivent faire."},
      {who:'salima', text:"Que signifie le feu rouge ?"},
      {who:'father', text:"Rouge veut dire STOP compl√®tement. Ne traverse pas avant que ce soit s√ªr."},
      {who:'salima', text:"Et le feu jaune ?"},
      {who:'father', text:"Ralentis et pr√©pare-toi √† t'arr√™ter. Ne te pr√©cipite jamais sur un feu jaune."},
      {who:'salima', text:"Et le feu vert ?"},
      {who:'father', text:"Va seulement quand c'est s√ªr. Regarde toujours √† gauche et √† droite d'abord."},
      {who:'salima', text:"Les feux pour pi√©tons ?"},
      {who:'father', text:"Traverse uniquement quand la figurine qui marche s'affiche. Si elle clignote, finis vite."},
      {who:'salima', text:"Les feux clignotants pr√®s des trains ou travaux ?"},
      {who:'father', text:"Jaune clignotant = ralentir. Rouge clignotant = arr√™t. Danger !"},
      {who:'salima', text:"Et les personnes daltoniennes ?"},
      {who:'father', text:"Feu du haut = stop, feu du bas = va. Les formes aident tout le monde."},
      {who:'salima', text:"D'autres conseils ?"},
      {who:'father', text:"Tiens la main, surveille les v√©los, porte des v√™tements lumineux, ob√©is aux agents."}
    ],
    rules: [
      {title:"Feu Rouge üö¶", def:"Arr√™t complet. Attends sur le trottoir jusqu'au vert.", example:"Salima reste sur le trottoir et attend.", emoji:"üõë"},
      {title:"Feu Jaune üíõ", def:"Ralentis, pr√©pare-toi √† t'arr√™ter.", example:"Salima tient la main de son p√®re.", emoji:"‚ö†Ô∏è"},
      {title:"Feu Vert üíö", def:"Va quand c'est s√ªr, regarde des deux c√¥t√©s.", example:"Salima regarde √† gauche et √† droite avant de traverser.", emoji:"‚úÖ"},
      {title:"Signal Pi√©ton üö∂", def:"Marche seulement quand la figurine verte appara√Æt.", example:"Salima traverse sur le feu pi√©ton stable.", emoji:"üö∂‚Äç‚ôÄÔ∏è"},
      {title:"Feux Clignotants ‚ö†Ô∏è", def:"Jaune clignotant = attention, rouge clignotant = arr√™t.", example:"Salima ralentit dans les zones de travaux.", emoji:"üöß"},
      {title:"Signaux Train/Tram üöã", def:"Arr√™te-toi quand les feux clignotent ou les barri√®res se ferment.", example:"Salima ne traverse jamais les rails quand √ßa clignote.", emoji:"üöÇ"},
      {title:"V√©hicules d'Urgence üö®", def:"√âcarte-toi et laisse-les passer.", example:"Salima va sur le trottoir pour l'ambulance.", emoji:"üöë"},
      {title:"V√©los & Trottinettes üö≤", def:"V√©rifie les pistes cyclables, attends les cyclistes.", example:"Salima v√©rifie la piste avant de traverser.", emoji:"üö¥"},
      {title:"S√©curit√© Nocturne üåô", def:"Porte des v√™tements lumineux/r√©fl√©chissants.", example:"Salima porte une veste lumineuse la nuit.", emoji:"ü¶∫"},
      {title:"Agents de Circulation üëÆ", def:"Ob√©is aux agents et surveillants.", example:"Salima attend le signal de l'agent √† l'√©cole.", emoji:"üëÆ‚Äç‚ôÄÔ∏è"}
    ],
    quizzes: [
      {q:"Le feu ROUGE signifie ?", opts:["Aller vite","Stop complet","Faire signe"], correct:1},
      {q:"Le feu JAUNE ?", opts:["Acc√©l√©rer","Ralentir et se pr√©parer","Chanter"], correct:1},
      {q:"Le feu VERT ?", opts:["Regarder des deux c√¥t√©s et aller","Fermer les yeux et courir","Pousser le v√©lo"], correct:0},
      {q:"Traverser en toute s√©curit√© ?", opts:["Quand la figurine verte marche","Quand la voiture klaxonne","Quand tu le sens"], correct:0},
      {q:"Feu ROUGE clignotant ?", opts:["Arr√™ter et attendre","Traverser vite","Ignorer"], correct:0}
    ],
    correctMsg: "‚úÖ Correct !",
    wrongMsg: "‚ùå R√©essaie."
  },
  en: {
    title: "üåü Salima's Traffic Light Adventure üåü",
    salimaName: "Salima üëß",
    fatherName: "Father üë®‚Äçü¶±",
    dialogue: [
      {who:'salima', text:"Daddy, why are there so many traffic lights and signs?"},
      {who:'father', text:"They help everyone stay safe. Traffic lights tell drivers and people what to do."},
      {who:'salima', text:"What does the red light mean?"},
      {who:'father', text:"Red means STOP completely. Do not step until safe."},
      {who:'salima', text:"Yellow?"},
      {who:'father', text:"Slow down and prepare to stop. Never rush a yellow light."},
      {who:'salima', text:"Green?"},
      {who:'father', text:"Go only when safe. Always look left and right first."},
      {who:'salima', text:"Pedestrian lights?"},
      {who:'father', text:"Cross only when the walking figure shows. If it flashes, finish quickly."},
      {who:'salima', text:"Flashing lights near trains or work?"},
      {who:'father', text:"Flashing yellow = slow. Flashing red = stop. Danger!"},
      {who:'salima', text:"Color-blind people?"},
      {who:'father', text:"Top light = stop, bottom = go. Shapes help everyone."},
      {who:'salima', text:"Any other tips?"},
      {who:'father', text:"Hold hands, watch bikes, wear bright clothes, obey guards."}
    ],
    rules: [
      {title:"Red Light üö¶", def:"Stop completely. Wait on the curb until green.", example:"Salima stands at the curb and waits.", emoji:"üõë"},
      {title:"Yellow Light üíõ", def:"Slow down, prepare to stop.", example:"Salima holds her father's hand.", emoji:"‚ö†Ô∏è"},
      {title:"Green Light üíö", def:"Go when safe, look both ways.", example:"Salima looks left and right before crossing.", emoji:"‚úÖ"},
      {title:"Pedestrian Signal üö∂", def:"Walk only when green figure shows.", example:"Salima crosses only on steady walk figure.", emoji:"üö∂‚Äç‚ôÄÔ∏è"},
      {title:"Flashing Lights ‚ö†Ô∏è", def:"Flashing yellow = care, flashing red = stop.", example:"Salima slows in work zones.", emoji:"üöß"},
      {title:"Train/Tram Signals üöã", def:"Stop when lights flash or barriers close.", example:"Salima never crosses tracks while flashing.", emoji:"üöÇ"},
      {title:"Emergency Vehicles üö®", def:"Move aside and let them pass.", example:"Salima steps to sidewalk for ambulance.", emoji:"üöë"},
      {title:"Bicycles & Scooters üö≤", def:"Look for bike lanes, wait for cyclists.", example:"Salima checks bike lane before crossing.", emoji:"üö¥"},
      {title:"Night Safety üåô", def:"Wear bright/reflective clothes.", example:"Salima wears a bright jacket after dark.", emoji:"ü¶∫"},
      {title:"School/Crossing Guards üëÆ", def:"Obey guards and officers.", example:"Salima waits for guard's signal at school.", emoji:"üëÆ‚Äç‚ôÄÔ∏è"}
    ],
    quizzes: [
      {q:"RED light means?", opts:["Go quickly","Stop completely","Wave hands"], correct:1},
      {q:"YELLOW light?", opts:["Speed up","Slow down & prepare","Sing"], correct:1},
      {q:"GREEN light?", opts:["Look both ways & go","Close eyes & run","Push bike"], correct:0},
      {q:"Pedestrian safe crossing?", opts:["When walking figure shows","When car honks","Whenever you feel"], correct:0},
      {q:"Flashing RED?", opts:["Stop & wait","Cross quickly","Ignore"], correct:0}
    ],
    correctMsg: "‚úÖ Correct!",
    wrongMsg: "‚ùå Try again."
  },
  ar: {
    title: "üåü ŸÖÿ∫ÿßŸÖÿ±ÿ© ÿ≥ŸÑŸäŸÖÿ© ŸÖÿπ ÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± üåü",
    salimaName: "ÿ≥ŸÑŸäŸÖÿ© üëß",
    fatherName: "ÿ£ÿ®Ÿä üë®‚Äçü¶±",
    dialogue: [
      {who:'salima', text:"ÿ£ÿ®Ÿäÿå ŸÑŸÖÿßÿ∞ÿß ÿ™Ÿàÿ¨ÿØ ÿßŸÑŸÉÿ´Ÿäÿ± ŸÖŸÜ ÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± ŸàÿßŸÑŸÑŸàÿ≠ÿßÿ™ÿü"},
      {who:'father', text:"ÿ•ŸÜŸáÿß ÿ™ÿ≥ÿßÿπÿØ ÿßŸÑÿ¨ŸÖŸäÿπ ÿπŸÑŸâ ÿßŸÑÿ®ŸÇÿßÿ° ÿ¢ŸÖŸÜŸäŸÜ. ÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± ÿ™ÿÆÿ®ÿ± ÿßŸÑÿ≥ÿßÿ¶ŸÇŸäŸÜ ŸàÿßŸÑŸÖÿ¥ÿßÿ© ÿ®ŸÖÿß Ÿäÿ¨ÿ® ŸÅÿπŸÑŸá."},
      {who:'salima', text:"ŸÖÿßÿ∞ÿß ŸäÿπŸÜŸä ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿ≠ŸÖÿ±ÿü"},
      {who:'father', text:"ÿßŸÑÿ£ÿ≠ŸÖÿ± ŸäÿπŸÜŸä ÿ™ŸàŸÇŸÅ ÿ™ŸÖÿßŸÖÿßŸã. ŸÑÿß ÿ™ÿ™ÿ≠ÿ±ŸÉ ÿ≠ÿ™Ÿâ Ÿäÿµÿ®ÿ≠ ÿßŸÑÿ£ŸÖÿ± ÿ¢ŸÖŸÜÿßŸã."},
      {who:'salima', text:"ŸàÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿµŸÅÿ±ÿü"},
      {who:'father', text:"ÿ™ÿ®ÿßÿ∑ÿ£ Ÿàÿßÿ≥ÿ™ÿπÿØ ŸÑŸÑÿ™ŸàŸÇŸÅ. ŸÑÿß ÿ™ÿ™ÿ≥ÿ±ÿπ ÿ£ÿ®ÿØÿßŸã ÿπŸÑŸâ ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿµŸÅÿ±."},
      {who:'salima', text:"ŸàÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿÆÿ∂ÿ±ÿü"},
      {who:'father', text:"ÿ™ÿ≠ÿ±ŸÉ ŸÅŸÇÿ∑ ÿπŸÜÿØŸÖÿß ŸäŸÉŸàŸÜ ÿ¢ŸÖŸÜÿßŸã. ÿßŸÜÿ∏ÿ± ÿØÿßÿ¶ŸÖÿßŸã Ÿäÿ≥ÿßÿ±ÿßŸã ŸàŸäŸÖŸäŸÜÿßŸã ÿ£ŸàŸÑÿßŸã."},
      {who:'salima', text:"ÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ¥ÿßÿ©ÿü"},
      {who:'father', text:"ÿßÿπÿ®ÿ± ŸÅŸÇÿ∑ ÿπŸÜÿØŸÖÿß ÿ™ÿ∏Ÿáÿ± ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ¥Ÿä. ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿ™ŸàŸÖÿ∂ÿå ÿ£ŸÉŸÖŸÑ ÿ®ÿ≥ÿ±ÿπÿ©."},
      {who:'salima', text:"ÿßŸÑÿ£ÿ∂Ÿàÿßÿ° ÿßŸÑŸàÿßŸÖÿ∂ÿ© ÿ®ÿßŸÑŸÇÿ±ÿ® ŸÖŸÜ ÿßŸÑŸÇÿ∑ÿßÿ±ÿßÿ™ ÿ£Ÿà ÿßŸÑÿ£ÿπŸÖÿßŸÑÿü"},
      {who:'father', text:"ÿßŸÑÿ£ÿµŸÅÿ± ÿßŸÑŸàÿßŸÖÿ∂ = ÿ•ÿ®ÿ∑ÿßÿ°. ÿßŸÑÿ£ÿ≠ŸÖÿ± ÿßŸÑŸàÿßŸÖÿ∂ = ÿ™ŸàŸÇŸÅ. ÿÆÿ∑ÿ±!"},
      {who:'salima', text:"ŸàÿßŸÑÿ£ÿ¥ÿÆÿßÿµ ÿßŸÑÿ∞ŸäŸÜ ŸÑÿß ŸäŸÖŸäÿ≤ŸàŸÜ ÿßŸÑÿ£ŸÑŸàÿßŸÜÿü"},
      {who:'father', text:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿπŸÑŸàŸä = ÿ™ŸàŸÇŸÅÿå ÿßŸÑÿ≥ŸÅŸÑŸä = ÿ™ÿ≠ÿ±ŸÉ. ÿßŸÑÿ£ÿ¥ŸÉÿßŸÑ ÿ™ÿ≥ÿßÿπÿØ ÿßŸÑÿ¨ŸÖŸäÿπ."},
      {who:'salima', text:"ÿ£Ÿä ŸÜÿµÿßÿ¶ÿ≠ ÿ£ÿÆÿ±Ÿâÿü"},
      {who:'father', text:"ÿ£ŸÖÿ≥ŸÉ ŸäÿØŸäÿå ÿ±ÿßŸÇÿ® ÿßŸÑÿØÿ±ÿßÿ¨ÿßÿ™ÿå ÿßÿ±ÿ™ÿØ ŸÖŸÑÿßÿ®ÿ≥ ÿ≥ÿßÿ∑ÿπÿ©ÿå ÿ£ÿ∑ÿπ ÿßŸÑÿ≠ÿ±ÿßÿ≥."}
    ],
    rules: [
      {title:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿ≠ŸÖÿ± üö¶", def:"ÿ™ŸàŸÇŸÅ ÿ™ŸÖÿßŸÖÿßŸã. ÿßŸÜÿ™ÿ∏ÿ± ÿπŸÑŸâ ÿßŸÑÿ±ÿµŸäŸÅ ÿ≠ÿ™Ÿâ Ÿäÿµÿ®ÿ≠ ÿ£ÿÆÿ∂ÿ±.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ŸÇŸÅ ÿπŸÑŸâ ÿßŸÑÿ±ÿµŸäŸÅ Ÿàÿ™ŸÜÿ™ÿ∏ÿ±.", emoji:"üõë"},
      {title:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿµŸÅÿ± üíõ", def:"ÿ™ÿ®ÿßÿ∑ÿ£ÿå ÿßÿ≥ÿ™ÿπÿØ ŸÑŸÑÿ™ŸàŸÇŸÅ.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ŸÖÿ≥ŸÉ ŸäÿØ ŸàÿßŸÑÿØŸáÿß.", emoji:"‚ö†Ô∏è"},
      {title:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿÆÿ∂ÿ± üíö", def:"ÿ™ÿ≠ÿ±ŸÉ ÿπŸÜÿØŸÖÿß ŸäŸÉŸàŸÜ ÿ¢ŸÖŸÜÿßŸãÿå ÿßŸÜÿ∏ÿ± ŸÅŸä ŸÉŸÑÿß ÿßŸÑÿßÿ™ÿ¨ÿßŸáŸäŸÜ.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ŸÜÿ∏ÿ± Ÿäÿ≥ÿßÿ±ÿßŸã ŸàŸäŸÖŸäŸÜÿßŸã ŸÇÿ®ŸÑ ÿßŸÑÿπÿ®Ÿàÿ±.", emoji:"‚úÖ"},
      {title:"ÿ•ÿ¥ÿßÿ±ÿ© ÿßŸÑŸÖÿ¥ÿßÿ© üö∂", def:"ÿßŸÖÿ¥ ŸÅŸÇÿ∑ ÿπŸÜÿØŸÖÿß ÿ™ÿ∏Ÿáÿ± ÿßŸÑÿµŸàÿ±ÿ© ÿßŸÑÿÆÿ∂ÿ±ÿßÿ°.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ÿπÿ®ÿ± ŸÅŸÇÿ∑ ÿπŸÑŸâ ÿ•ÿ¥ÿßÿ±ÿ© ÿßŸÑŸÖÿ¥Ÿä ÿßŸÑÿ´ÿßÿ®ÿ™ÿ©.", emoji:"üö∂‚Äç‚ôÄÔ∏è"},
      {title:"ÿßŸÑÿ£ÿ∂Ÿàÿßÿ° ÿßŸÑŸàÿßŸÖÿ∂ÿ© ‚ö†Ô∏è", def:"ÿßŸÑÿ£ÿµŸÅÿ± ÿßŸÑŸàÿßŸÖÿ∂ = ÿßÿ≠ÿ∞ÿ±ÿå ÿßŸÑÿ£ÿ≠ŸÖÿ± ÿßŸÑŸàÿßŸÖÿ∂ = ÿ™ŸàŸÇŸÅ.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ÿ™ÿ®ÿßÿ∑ÿ£ ŸÅŸä ŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑÿπŸÖŸÑ.", emoji:"üöß"},
      {title:"ÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿßŸÑŸÇÿ∑ÿßÿ±/ÿßŸÑÿ™ÿ±ÿßŸÖ üöã", def:"ÿ™ŸàŸÇŸÅ ÿπŸÜÿØŸÖÿß ÿ™ŸàŸÖÿ∂ ÿßŸÑÿ£ÿ∂Ÿàÿßÿ° ÿ£Ÿà ÿ™ÿ∫ŸÑŸÇ ÿßŸÑÿ≠Ÿàÿßÿ¨ÿ≤.", example:"ÿ≥ŸÑŸäŸÖÿ© ŸÑÿß ÿ™ÿπÿ®ÿ± ÿßŸÑÿ≥ŸÉÿ© ÿ£ÿ®ÿØÿßŸã ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑŸàŸÖŸäÿ∂.", emoji:"üöÇ"},
      {title:"ŸÖÿ±ŸÉÿ®ÿßÿ™ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶ üö®", def:"ÿßÿ®ÿ™ÿπÿØ Ÿàÿßÿ™ÿ±ŸÉŸáÿß ÿ™ŸÖÿ±.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ÿ∞Ÿáÿ® ÿ•ŸÑŸâ ÿßŸÑÿ±ÿµŸäŸÅ ŸÑŸÑÿ•ÿ≥ÿπÿßŸÅ.", emoji:"üöë"},
      {title:"ÿßŸÑÿØÿ±ÿßÿ¨ÿßÿ™ ŸàÿßŸÑÿ≥ŸÉŸàÿ™ÿ±ÿßÿ™ üö≤", def:"ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿ≥ÿßÿ±ÿßÿ™ ÿßŸÑÿØÿ±ÿßÿ¨ÿßÿ™ÿå ÿßŸÜÿ™ÿ∏ÿ± ÿßŸÑÿØÿ±ÿßÿ¨ŸäŸÜ.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ŸÅÿ≠ÿµ ŸÖÿ≥ÿßÿ± ÿßŸÑÿØÿ±ÿßÿ¨ÿßÿ™ ŸÇÿ®ŸÑ ÿßŸÑÿπÿ®Ÿàÿ±.", emoji:"üö¥"},
      {title:"ÿßŸÑÿ≥ŸÑÿßŸÖÿ© ÿßŸÑŸÑŸäŸÑŸäÿ© üåô", def:"ÿßÿ±ÿ™ÿØ ŸÖŸÑÿßÿ®ÿ≥ ÿ≥ÿßÿ∑ÿπÿ©/ÿπÿßŸÉÿ≥ÿ©.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ÿ±ÿ™ÿØŸä ÿ≥ÿ™ÿ±ÿ© ÿ≥ÿßÿ∑ÿπÿ© ÿ®ÿπÿØ ÿßŸÑÿ∏ŸÑÿßŸÖ.", emoji:"ü¶∫"},
      {title:"ÿ≠ÿ±ÿßÿ≥ ÿßŸÑŸÖÿ±Ÿàÿ± üëÆ", def:"ÿ£ÿ∑ÿπ ÿßŸÑÿ≠ÿ±ÿßÿ≥ ŸàÿßŸÑÿ∂ÿ®ÿßÿ∑.", example:"ÿ≥ŸÑŸäŸÖÿ© ÿ™ŸÜÿ™ÿ∏ÿ± ÿ•ÿ¥ÿßÿ±ÿ© ÿßŸÑÿ≠ÿßÿ±ÿ≥ ŸÅŸä ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©.", emoji:"üëÆ‚Äç‚ôÄÔ∏è"}
    ],
    quizzes: [
      {q:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿ≠ŸÖÿ± ŸäÿπŸÜŸäÿü", opts:["ÿßÿ∞Ÿáÿ® ÿ®ÿ≥ÿ±ÿπÿ©","ÿ™ŸàŸÇŸÅ ÿ™ŸÖÿßŸÖÿßŸã","ŸÑŸàÿ≠ ÿ®ŸäÿØŸäŸÉ"], correct:1},
      {q:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿµŸÅÿ±ÿü", opts:["ÿ£ÿ≥ÿ±ÿπ","ÿ™ÿ®ÿßÿ∑ÿ£ Ÿàÿßÿ≥ÿ™ÿπÿØ","ÿ∫ŸÜŸä"], correct:1},
      {q:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿÆÿ∂ÿ±ÿü", opts:["ÿßŸÜÿ∏ÿ± ŸÅŸä ŸÉŸÑÿß ÿßŸÑÿßÿ™ÿ¨ÿßŸáŸäŸÜ Ÿàÿßÿ∞Ÿáÿ®","ÿ£ÿ∫ŸÖÿ∂ ÿπŸäŸÜŸäŸÉ Ÿàÿßÿ±ŸÉÿ∂","ÿßÿØŸÅÿπ ÿßŸÑÿØÿ±ÿßÿ¨ÿ©"], correct:0},
      {q:"ÿßŸÑÿπÿ®Ÿàÿ± ÿßŸÑÿ¢ŸÖŸÜ ŸÑŸÑŸÖÿ¥ÿßÿ©ÿü", opts:["ÿπŸÜÿØŸÖÿß ÿ™ÿ∏Ÿáÿ± ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ¥Ÿä","ÿπŸÜÿØŸÖÿß ÿ™ÿ®ŸàŸÇ ÿßŸÑÿ≥Ÿäÿßÿ±ÿ©","ŸÖÿ™Ÿâ ŸÖÿß ÿ¥ÿπÿ±ÿ™"], correct:0},
      {q:"ÿßŸÑÿ∂Ÿàÿ° ÿßŸÑÿ£ÿ≠ŸÖÿ± ÿßŸÑŸàÿßŸÖÿ∂ÿü", opts:["ÿ™ŸàŸÇŸÅ ŸàÿßŸÜÿ™ÿ∏ÿ±","ÿßÿπÿ®ÿ± ÿ®ÿ≥ÿ±ÿπÿ©","ÿ™ÿ¨ÿßŸáŸÑ"], correct:0}
    ],
    correctMsg: "‚úÖ ÿµÿ≠Ÿäÿ≠!",
    wrongMsg: "‚ùå ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ."
  }
};

function initLang() {
  const savedLang = localStorage.getItem('salimaLang');
  const browserLang = navigator.language.split('-')[0];
  
  if (savedLang && ['fr', 'en', 'ar'].includes(savedLang)) {
    currentLang = savedLang;
  } else if (['fr', 'en', 'ar'].includes(browserLang)) {
    currentLang = browserLang;
  }
  
  updateLangUI();
  renderContent();
}

function changeLang(lang) {
  if (lang === currentLang) return;
  
  currentLang = lang;
  localStorage.setItem('salimaLang', lang);
  
  document.body.style.opacity = '0';
  setTimeout(() => {
    updateLangUI();
    renderContent();
    document.body.style.opacity = '1';
  }, 200);
}

function updateLangUI() {
  if (currentLang === 'ar') {
    document.body.classList.add('rtl');
    document.documentElement.setAttribute('lang', 'ar');
  } else {
    document.body.classList.remove('rtl');
    document.documentElement.setAttribute('lang', currentLang);
  }
  
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.lang === currentLang);
  });
}

function renderContent() {
  const t = translations[currentLang];
  
  document.getElementById('pageTitle').textContent = t.title;
  
  renderDialogue(t);
  renderRules(t);
  renderQuizzes(t);
}

function renderDialogue(t) {
  const chat = document.getElementById('chat');
  chat.innerHTML = '';
  
  t.dialogue.forEach((line, index) => {
    setTimeout(() => {
      const div = document.createElement('div');
      div.className = 'bubble ' + (line.who === 'salima' ? 'salima' : 'father');
      div.innerHTML = `<span class="name">${line.who === 'salima' ? t.salimaName : t.fatherName}:</span> ${line.text}`;
      chat.appendChild(div);
    }, index * 100);
  });
}

function renderRules(t) {
  const wrap = document.getElementById('rules');
  wrap.innerHTML = '';
  
  t.rules.forEach((r, index) => {
    const rule = document.createElement('div');
    rule.className = 'rule';
    rule.innerHTML = `
      <div class="placeholder">${r.emoji}</div>
      <h4>${r.title}</h4>
      <p><strong>${r.def}</strong></p>
      <p><em>${r.example}</em></p>
    `;
    wrap.appendChild(rule);
  });
}

function renderQuizzes(t) {
  const wrap = document.getElementById('quizzes');
  wrap.innerHTML = '';
  
  t.quizzes.forEach((q, i) => {
    const card = document.createElement('div');
    card.className = 'quizbox';
    const optsHtml = q.opts.map((o, j) => `<button onclick="answerQuiz(event,${i},${j})">${o}</button>`).join('');
    card.innerHTML = `<div class="quiz">${i + 1}. ${q.q}</div><div class="opts">${optsHtml}</div><div class="feedback"></div>`;
    wrap.appendChild(card);
  });
}

function answerQuiz(e, qIndex, optIndex) {
  const t = translations[currentLang];
  const card = e.target.closest('.quizbox');
  const opts = card.querySelectorAll('button');
  const feedback = card.querySelector('.feedback');
  const correct = t.quizzes[qIndex].correct;
  
  opts.forEach((b, idx) => {
    b.disabled = true;
    b.classList.remove('correct', 'wrong');
    if (idx === correct) b.classList.add('correct');
  });
  
  if (optIndex === correct) {
    e.target.classList.add('correct');
    feedback.textContent = t.correctMsg;
    feedback.style.color = '#1a7f37';
  } else {
    e.target.classList.add('wrong');
    feedback.textContent = t.wrongMsg;
    feedback.style.color = '#d02b2b';
  }
}

document.addEventListener('DOMContentLoaded', initLang);
</script>

</body>
</html>
